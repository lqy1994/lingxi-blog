<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="cn.edu.sdu.wh.lqy.lingxi.blog.mapper.map.ArticleMapper2">

    <resultMap id="BaseResultMap" type="cn.edu.sdu.wh.lqy.lingxi.blog.model.Vo.Article">
        <id column="id" jdbcType="INTEGER" property="id"/>
        <result column="title" jdbcType="VARCHAR" property="title"/>
        <result column="thumbnail" jdbcType="VARCHAR" property="thumbnail"/>
        <result column="created" jdbcType="INTEGER" property="created"/>
        <result column="modified" jdbcType="INTEGER" property="modified"/>
        <result column="author_id" jdbcType="INTEGER" property="authorId"/>
        <result column="type" jdbcType="VARCHAR" property="type"/>
        <result column="status" jdbcType="VARCHAR" property="status"/>
        <result column="tags" jdbcType="VARCHAR" property="tags"/>
        <result column="categories" jdbcType="VARCHAR" property="categories"/>
        <result column="hits" jdbcType="INTEGER" property="hits"/>
        <result column="comments_num" jdbcType="INTEGER" property="commentsNum"/>
        <result column="allow_comment" jdbcType="BIT" property="allowComment"/>
        <result column="allow_ping" jdbcType="BIT" property="allowPing"/>
        <result column="allow_feed" jdbcType="BIT" property="allowFeed"/>
        <result column="word_cnt" jdbcType="INTEGER" property="wordCnt"/>
    </resultMap>

    <resultMap extends="BaseResultMap" id="ResultMapWithBLOBs" type="cn.edu.sdu.wh.lqy.lingxi.blog.model.Vo.Article">
        <result column="content" jdbcType="LONGVARCHAR" property="content"/>
    </resultMap>

    <sql id="Base_Column_List">
        id, title, thumbnail, created, modified, author_id, type, `status`, tags, categories, hits,
        comments_num, allow_comment, allow_ping, allow_feed, word_cnt
    </sql>

    <sql id="Blob_Column_List">
        `content`
    </sql>

    <select id="countByTypeAndStatus" resultType="java.lang.Long">
        SELECT count(*)
        FROM article
        where type = #{type} and status = #{status}
    </select>

    <select id="findByCatalog" resultMap="BaseResultMap" parameterType="Integer">
        select a.*
        from article a left join article_meta b on a.id = b.cid
        where b.mid = #{value} and a.status = 'publish' and a.type = 'post'
        order by a.created desc
    </select>

</mapper>